<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ProfeMaster.Pages.EventsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    BackgroundColor="#FFFFFF"
    Title=""
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>

        <!-- Paleta (mesma do Agenda/Plans/Lessons/Editor) -->
        <Color x:Key="PmText">#2B2B2B</Color>
        <Color x:Key="PmMuted">#7B7B7B</Color>
        <Color x:Key="PmStroke">#E6E6E6</Color>

        <LinearGradientBrush x:Key="PmGradient" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#B66AF4" Offset="0" />
            <GradientStop Color="#7E97D9" Offset="1" />
        </LinearGradientBrush>

        <Style x:Key="PmCardBorder" TargetType="Border">
            <Setter Property="BackgroundColor" Value="#FFFFFF" />
            <Setter Property="Stroke" Value="{StaticResource PmStroke}" />
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="StrokeShape" Value="RoundRectangle 18" />
        </Style>

        <Style x:Key="PmBtnPrimary" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="TextColor" Value="#FFFFFF" />
            <Setter Property="Background" Value="{StaticResource PmGradient}" />
            <Setter Property="Padding" Value="14,12" />
        </Style>

        <Style x:Key="PmBtnSoft" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="TextColor" Value="{StaticResource PmText}" />
            <Setter Property="BackgroundColor" Value="#F2F2F2" />
            <Setter Property="Padding" Value="12,10" />
        </Style>

        <Style x:Key="PmBtnDark" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="TextColor" Value="#FFFFFF" />
            <Setter Property="BackgroundColor" Value="#243056" />
            <Setter Property="Padding" Value="12,10" />
        </Style>

        <Style x:Key="PmBtnDanger" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="TextColor" Value="#FFFFFF" />
            <Setter Property="BackgroundColor" Value="#3A2040" />
            <Setter Property="Padding" Value="12,10" />
        </Style>

    </ContentPage.Resources>

    <Grid Padding="18" RowSpacing="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ===== TOP BAR ===== -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">

            <VerticalStackLayout Spacing="2" VerticalOptions="Center">
                <Label Text="Eventos"
                       FontAttributes="Bold"
                       FontSize="18"
                       TextColor="{StaticResource PmText}" />
                <Label x:Name="SubLabel"
                       Text="Gerencie eventos com atrações por dia"
                       TextColor="{StaticResource PmMuted}"
                       FontSize="10" />
            </VerticalStackLayout>

            <Button Grid.Column="1"
                    Text="Atualizar"
                    Style="{StaticResource PmBtnSoft}"
                    Clicked="OnRefresh"
                    VerticalOptions="Center"/>

            <Button Grid.Column="2"
                    Text="+ Novo"
                    Style="{StaticResource PmBtnPrimary}"
                    Clicked="OnAdd"
                    VerticalOptions="Center"/>

        </Grid>

        <!-- ===== CONTEXTO / DICA ===== -->
        <Border Grid.Row="1" Style="{StaticResource PmCardBorder}">
            <Grid Padding="12" ColumnDefinitions="Auto,*" ColumnSpacing="10">
                <Border WidthRequest="28"
                        HeightRequest="28"
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 10"
                        BackgroundColor="#F2F2F2"
                        VerticalOptions="Center">
                    <Label Text="i"
                           FontAttributes="Bold"
                           HorizontalTextAlignment="Center"
                           VerticalTextAlignment="Center"
                           TextColor="{StaticResource PmText}"/>
                </Border>

                <Label Grid.Column="1"
                       Text="Dica: crie o evento e depois adicione as atrações por dia no editor."
                       TextColor="{StaticResource PmMuted}"
                       FontSize="11"
                       VerticalOptions="Center"/>
            </Grid>
        </Border>

        <!-- ===== LIST ===== -->
        <Grid Grid.Row="2">

            <Label x:Name="EmptyLabel"
                   IsVisible="False"
                   Text="Nenhum evento criado ainda."
                   TextColor="{StaticResource PmMuted}"
                   HorizontalTextAlignment="Center"
                   Margin="0,24,0,0"/>

            <CollectionView x:Name="List"
                            SelectionMode="Single"
                            SelectionChanged="OnSelected"
                            Margin="0,0,0,10">

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,0,0,12" Style="{StaticResource PmCardBorder}">
                            <Grid Padding="12"
                                  ColumnDefinitions="Auto,*,Auto"
                                  ColumnSpacing="12">

                                <!-- Thumb -->
                                <Border WidthRequest="56"
                                        HeightRequest="56"
                                        Stroke="{StaticResource PmStroke}"
                                        StrokeThickness="2"
                                        StrokeShape="RoundRectangle 14"
                                        BackgroundColor="#FFFFFF"
                                        VerticalOptions="Start">
                                    <Image Aspect="AspectFill"
                                           Source="{Binding ThumbLocalPath}" />
                                </Border>

                                <!-- Textos -->
                                <Grid Grid.Column="1"
                                      RowDefinitions="Auto,Auto,Auto"
                                      RowSpacing="4"
                                      VerticalOptions="Center">

                                    <Label Grid.Row="0"
                                           Text="{Binding Title}"
                                           FontAttributes="Bold"
                                           FontSize="16"
                                           TextColor="#7A2FA6"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="1"/>

                                    <Label Grid.Row="1"
                                           Text="{Binding IntervalText}"
                                           TextColor="{StaticResource PmMuted}"
                                           FontSize="11"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="1"/>

                                    <Label Grid.Row="2"
                                           Text="{Binding SlotsText}"
                                           TextColor="{StaticResource PmMuted}"
                                           FontSize="11"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="1"/>
                                </Grid>

                                <!-- Ações -->
                                <VerticalStackLayout Grid.Column="2"
                                                     Spacing="8"
                                                     VerticalOptions="Center">
                                    <Button Text="Editar"
                                            Style="{StaticResource PmBtnDark}"
                                            Clicked="OnEditClicked"/>
                                    <Button Text="Excluir"
                                            Style="{StaticResource PmBtnDanger}"
                                            Clicked="OnDeleteClicked"/>
                                </VerticalStackLayout>

                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>

        </Grid>

    </Grid>
</ContentPage>
