<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ProfeMaster.Pages.EventDetailsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    BackgroundColor="#FFFFFF"
    Title=""
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>

        <!-- Paleta padrão -->
        <Color x:Key="PmText">#2B2B2B</Color>
        <Color x:Key="PmMuted">#7B7B7B</Color>
        <Color x:Key="PmStroke">#E6E6E6</Color>

        <LinearGradientBrush x:Key="PmGradient" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#B66AF4" Offset="0" />
            <GradientStop Color="#7E97D9" Offset="1" />
        </LinearGradientBrush>

        <Style x:Key="PmCardBorder" TargetType="Border">
            <Setter Property="BackgroundColor" Value="#FFFFFF" />
            <Setter Property="Stroke" Value="{StaticResource PmStroke}" />
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="StrokeShape" Value="RoundRectangle 18" />
        </Style>

        <Style x:Key="PmH1" TargetType="Label">
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="18" />
            <Setter Property="TextColor" Value="{StaticResource PmText}" />
        </Style>

        <Style x:Key="PmH2" TargetType="Label">
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="TextColor" Value="{StaticResource PmText}" />
        </Style>

        <Style x:Key="PmCaption" TargetType="Label">
            <Setter Property="FontSize" Value="10" />
            <Setter Property="TextColor" Value="{StaticResource PmMuted}" />
        </Style>

        <Style x:Key="PmBtnPrimary" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="TextColor" Value="#FFFFFF" />
            <Setter Property="Background" Value="{StaticResource PmGradient}" />
            <Setter Property="Padding" Value="14,12" />
        </Style>

        <Style x:Key="PmBtnSoft" TargetType="Button">
            <Setter Property="CornerRadius" Value="14" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="TextColor" Value="{StaticResource PmText}" />
            <Setter Property="BackgroundColor" Value="#F2F2F2" />
            <Setter Property="Padding" Value="14,12" />
        </Style>

        <Style x:Key="PmInnerCard" TargetType="Border">
            <Setter Property="BackgroundColor" Value="#FFFFFF" />
            <Setter Property="Stroke" Value="{StaticResource PmStroke}" />
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="StrokeShape" Value="RoundRectangle 14" />
        </Style>

        <Style x:Key="PmDayCard" TargetType="Border">
            <Setter Property="BackgroundColor" Value="#FFFFFF" />
            <Setter Property="Stroke" Value="{StaticResource PmStroke}" />
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="StrokeShape" Value="RoundRectangle 16" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="18" Spacing="12">

            <!-- TOP BAR -->
            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                <Label Text="Detalhes do evento" Style="{StaticResource PmH1}" VerticalOptions="Center"/>

                <Button Grid.Column="1"
                        Text="Recarregar"
                        Style="{StaticResource PmBtnSoft}"
                        Clicked="OnReload"
                        VerticalOptions="Center"/>
            </Grid>

            <!-- HEADER / DADOS -->
            <Border Style="{StaticResource PmCardBorder}">
                <VerticalStackLayout Padding="14" Spacing="10">

                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">

                        <!-- Thumb -->
                        <Border WidthRequest="72"
                                HeightRequest="72"
                                StrokeThickness="0"
                                StrokeShape="RoundRectangle 16"
                                BackgroundColor="#0f172a">
                            <Image x:Name="ThumbImage" Aspect="AspectFill" />
                        </Border>

                        <!-- Textos -->
                        <VerticalStackLayout Grid.Column="1" Spacing="4" VerticalOptions="Center">
                            <Label x:Name="TitleLabel"
                                   FontAttributes="Bold"
                                   FontSize="18"
                                   TextColor="{StaticResource PmText}"/>

                            <Label x:Name="MetaLabel"
                                   FontSize="12"
                                   TextColor="{StaticResource PmMuted}"/>

                            <Label x:Name="DescLabel"
                                   FontSize="12"
                                   TextColor="{StaticResource PmMuted}"
                                   LineBreakMode="WordWrap"/>
                        </VerticalStackLayout>

                    </Grid>

                </VerticalStackLayout>
            </Border>

            <!-- PROGRAMAÇÃO -->
            <Border Style="{StaticResource PmCardBorder}">
                <VerticalStackLayout Padding="14" Spacing="10">

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Programação (atrações)" Style="{StaticResource PmH2}"/>
                            <Label Text="Visualização por dia e horário."
                                   Style="{StaticResource PmCaption}"/>
                        </VerticalStackLayout>

                        <Button Grid.Column="1"
                                Text="Editar"
                                Style="{StaticResource PmBtnPrimary}"
                                Clicked="OnEdit"
                                VerticalOptions="Center"/>
                    </Grid>

                    <Label x:Name="EmptyLabel"
                           IsVisible="False"
                           Text="Sem dias/atrações. Abra o editor e defina o período."
                           TextColor="{StaticResource PmMuted}"
                           HorizontalTextAlignment="Center"
                           FontSize="11"
                           Margin="0,8,0,0"/>

                    <CollectionView x:Name="DaysList" SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>

                                <Border Style="{StaticResource PmDayCard}">
                                    <VerticalStackLayout Padding="12" Spacing="10">

                                        <Label Text="{Binding DateLabel}"
                                               FontAttributes="Bold"
                                               FontSize="13"
                                               TextColor="{StaticResource PmText}"/>

                                        <VerticalStackLayout BindableLayout.ItemsSource="{Binding Items}" Spacing="8">
                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate>

                                                    <Border Style="{StaticResource PmInnerCard}">
                                                        <Grid Padding="12"
                                                              ColumnDefinitions="Auto,*"
                                                              ColumnSpacing="10"
                                                              RowDefinitions="Auto">

                                                            <Label Text="{Binding TimeText}"
                                                                   TextColor="{StaticResource PmMuted}"
                                                                   FontSize="12"
                                                                   FontAttributes="Bold"
                                                                   VerticalOptions="Center"/>

                                                            <Label Grid.Column="1"
                                                                   Text="{Binding Title}"
                                                                   TextColor="{StaticResource PmText}"
                                                                   FontSize="13"
                                                                   LineBreakMode="TailTruncation"
                                                                   VerticalOptions="Center"/>

                                                        </Grid>
                                                    </Border>

                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </VerticalStackLayout>

                                    </VerticalStackLayout>
                                </Border>

                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Border>

            <!-- AÇÕES -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Text="Editar evento"
                        Style="{StaticResource PmBtnSoft}"
                        Clicked="OnEdit"/>

                <Button Grid.Column="1"
                        Text="Recarregar"
                        Style="{StaticResource PmBtnPrimary}"
                        Clicked="OnReload"/>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
